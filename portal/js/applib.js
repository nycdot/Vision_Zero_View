function isIE(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var b=navigator.userAgent,c=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}return-1==a?!1:!0}function checkCrashLegend(){var a=map.getScale();injury?yearly?a>64e3?($("#densityLegend").css("display","block"),$("#fatalityLegend").css("display","none"),$("#injuryLegend").css("display","none"),$("#layerLabel").css("display","none"),ped?$("#densityLegendText").text("Density of Pedestrian Injuries By Year"):bike?$("#densityLegendText").text("Density of Cyclist Injuries By Year"):motor?$("#densityLegendText").text("Density of Motorist Injuries By Year"):all&&$("#densityLegendText").text("Density of All Injuries By Year")):64001>a&&($("#densityLegend").css("display","none"),$("#fatalityLegend").css("display","block"),$("#injuryLegend").css("display","block"),$("#layerLabel").css("display","block")):monthly&&($("#densityLegend").css("display","none"),$("#fatalityLegend").css("display","block"),$("#injuryLegend").css("display","block")):fatality&&($("#densityLegend").css("display","none"),$("#fatalityLegend").css("display","block"),$("#injuryLegend").css("display","none"))}function injuryMonthlySet(a){var b=[],c=sliderLookup(a);$("#dateLabel").text(c),$("#date2Label").text(c),$("#date3Label").text(c),a=8*a,b.length=0,b.push(a,a+1,a+2,a+3,a+4,a+5,a+6,a+7),all?injury_monthly_all_Layer.setVisibleLayers(b):ped?injury_monthly_ped_Layer.setVisibleLayers(b):bike?injury_monthly_bike_Layer.setVisibleLayers(b):motor&&injury_monthly_motor_Layer.setVisibleLayers(b)}function injuryYearlySet(a){var b=[],c=slider2Lookup(a);$("#dateLabel").text(c),$("#date2Label").text(c),$("#date3Label").text(c),a=7*a,b.length=0,b.push(a,a+1,a+2,a+3,a+4,a+5,a+6),all?injury_yearly_all_Layer.setVisibleLayers(b):ped?injury_yearly_ped_Layer.setVisibleLayers(b):bike?injury_yearly_bike_Layer.setVisibleLayers(b):motor&&injury_yearly_motor_Layer.setVisibleLayers(b)}function fatalityMonthlySet(a){var b=[],c=sliderLookup(a);$("#dateLabel").text(c),$("#date2Label").text(c),$("#date3Label").text(c),a=4*a,b.length=0,b.push(a,a+1,a+2,a+3),all?fatality_monthly_all_Layer.setVisibleLayers(b):ped?fatality_monthly_ped_Layer.setVisibleLayers(b):bike?fatality_monthly_bike_Layer.setVisibleLayers(b):motor&&fatality_monthly_motor_Layer.setVisibleLayers(b)}function fatalityYearlySet(a){var b=[],c=slider2Lookup(a);$("#dateLabel").text(c),$("#date2Label").text(c),$("#date3Label").text(c),a=4*a,b.length=0,b.push(a,a+1,a+2,a+3),all?fatality_yearly_all_Layer.setVisibleLayers(b):ped?fatality_yearly_ped_Layer.setVisibleLayers(b):bike?fatality_yearly_bike_Layer.setVisibleLayers(b):motor&&fatality_yearly_motor_Layer.setVisibleLayers(b)}function toggleCrashLayers(){var a,b,c;a=injury?"Injuries":"Fatalities",b=yearly?"Yearly":"Monthly",all?c="All":ped?c="Pedestrian":bike?c="Cyclist":motor&&(c="Motorist");var d="Number of "+c+" "+a+": "+b;if($("#boxLabel").text("Citywide Total For"),$("#layerLabel").text(d),injury){if(monthly)all?(allCrashLayersOff(),injury_monthly_all_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)})):ped?(allCrashLayersOff(),injury_monthly_ped_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)})):bike?(allCrashLayersOff(),injury_monthly_bike_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)})):motor&&(allCrashLayersOff(),injury_monthly_motor_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),injuryMonthlySet(curInjuryValue)}));else if(yearly){all?(allCrashLayersOff(),injury_yearly_all_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)})):ped?(allCrashLayersOff(),injury_yearly_ped_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)})):bike?(allCrashLayersOff(),injury_yearly_bike_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)})):motor&&(allCrashLayersOff(),injury_yearly_motor_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),injuryYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),injuryYearlySet(curInjuryValue)}))}}else if(fatality){if(monthly)all?(allCrashLayersOff(),fatality_monthly_all_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)})):ped?(allCrashLayersOff(),fatality_monthly_ped_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)})):bike?(allCrashLayersOff(),fatality_monthly_bike_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)})):motor&&(allCrashLayersOff(),fatality_monthly_motor_Layer.setVisibility(!0),$("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none"),$("#monthSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityMonthlySet(curInjuryValue)}),$("#jqxslider").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider").jqxSlider("getValue"),fatalityMonthlySet(curInjuryValue)}));else if(yearly){all?(allCrashLayersOff(),fatality_yearly_all_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)})):ped?(allCrashLayersOff(),fatality_yearly_ped_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)})):bike?(allCrashLayersOff(),fatality_yearly_bike_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)})):motor&&(allCrashLayersOff(),fatality_yearly_motor_Layer.setVisibility(!0),$("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none"),$("#yearSelect").is(":visible")?(map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)):(map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)),$("#monthSelect , #yearSelect").on("change",function(){map.infoWindow.hide(),curInjuryValue=smallScreenCrashLayer(),fatalityYearlySet(curInjuryValue)}),$("#jqxslider2").bind("change",function(){map.infoWindow.hide(),curInjuryValue=$("#jqxslider2").jqxSlider("getValue"),fatalityYearlySet(curInjuryValue)}))}}checkCrashLegend(),checkStats()}function allCrashLayersOff(){injury_yearly_all_Layer.setVisibility(!1),injury_yearly_ped_Layer.setVisibility(!1),injury_yearly_motor_Layer.setVisibility(!1),injury_yearly_bike_Layer.setVisibility(!1),injury_monthly_all_Layer.setVisibility(!1),injury_monthly_ped_Layer.setVisibility(!1),injury_monthly_motor_Layer.setVisibility(!1),injury_monthly_bike_Layer.setVisibility(!1),fatality_yearly_all_Layer.setVisibility(!1),fatality_yearly_ped_Layer.setVisibility(!1),fatality_yearly_motor_Layer.setVisibility(!1),fatality_yearly_bike_Layer.setVisibility(!1),fatality_monthly_all_Layer.setVisibility(!1),fatality_monthly_ped_Layer.setVisibility(!1),fatality_monthly_motor_Layer.setVisibility(!1),fatality_monthly_bike_Layer.setVisibility(!1)}function checkCrashCatState(){map.infoWindow.hide(),setTimeout(function(){$("#injuriesBtn").hasClass("active")?(injury=!0,fatality=!1,$("#fatalitiesBtn").css("color","#777"),$("#injuriesBtn").css("color","rgb(255,255,255)")):$("#fatalitiesBtn").hasClass("active")&&(injury=!1,fatality=!0,$("#injuriesBtn").css("color","#777"),$("#fatalitiesBtn").css("color","rgb(255,255,255)")),toggleCrashLayers()},20),setTimeout(function(){$("#monthlyBtn").hasClass("active")?(monthly=!0,yearly=!1,$("#yearlyBtn").css("color","#777"),$("#monthlyBtn").css("color","rgb(255,255,255)")):$("#yearlyBtn").hasClass("active")&&(monthly=!1,yearly=!0,$("#monthlyBtn").css("color","#777"),$("#yearlyBtn").css("color","rgb(255,255,255)")),toggleCrashLayers()},20)}function addCrashLayers(){var a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/allFatalities_monthly/MapServer",b="fatality_monthly_all_Layer";fatality_monthly_all_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedFatalities_monthly/MapServer",b="fatality_monthly_ped_Layer",fatality_monthly_ped_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeFatalities_monthly/MapServer",b="fatality_monthly_bike_Layer",fatality_monthly_bike_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorFatalities_monthly/MapServer",b="fatality_monthly_motor_Layer",fatality_monthly_motor_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/allFatalities_yearly/MapServer",b="fatality_yearly_all_Layer",fatality_yearly_all_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedFatalities_yearly/MapServer",b="fatality_yearly_ped_Layer",fatality_yearly_ped_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeFatalities_yearly/MapServer",b=fatality_yearly_bike_Layer,fatality_yearly_bike_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorFatalities_yearly/MapServer",b=fatality_yearly_motor_Layer,fatality_yearly_motor_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/all_monthly_Injuries_and_fatalities/MapServer",b="injury_monthly_all_Layer",injury_monthly_all_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedFatalities_and_Injuries_monthly/MapServer",b="injury_monthly_ped_Layer",injury_monthly_ped_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeFatalities_and_Injuries_monthly/MapServer",b="injury_monthly_bike_Layer",injury_monthly_bike_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorFatalities_and_Injuries_monthly/MapServer",b="injury_monthly_motor_Layer",injury_monthly_motor_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/allInjury_yearly/MapServer",b=injury_yearly_all_Layer,injury_yearly_all_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedInjury_yearly/MapServer",b=injury_yearly_ped_Layer,injury_yearly_ped_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeInjury_yearly/MapServer",b=injury_yearly_bike_Layer,injury_yearly_bike_Layer=AddDynamicLayer(a,b,!1),a="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorInjury_yearly/MapServer",b=injury_yearly_motor_Layer,injury_yearly_motor_Layer=AddDynamicLayer(a,b,!1)}function AddLayer(a,b){a.setDisableClientCaching(!1),map.addLayer(a),a.setVisibility(b),a.on("update-start",function(){showLoading()}),a.on("update-end",function(){hideLoading()})}function AddDynamicLayer(a,b,c){var d=new esri.layers.ImageParameters;d.format="jpeg";var e=new esri.layers.ArcGISDynamicMapServiceLayer(a,{id:b,opacity:.8,imageParameters:d});return e.setDisableClientCaching(!1),map.addLayer(e),e.setVisibility(c),e.on("load",function(){e.minScale=0,e.maxScale=0}),e.on("update-start",function(){showLoading()}),e.on("update-end",function(){hideLoading()}),e}function IdentifyTaskInit(){$(document).ready(function(){allIdentifyParams=new esri.tasks.IdentifyParameters,allIdentifyParams.tolerance=4,allIdentifyParams.returnGeometry=!0,allIdentifyParams.layerOption=esri.tasks.IdentifyParameters.LAYER_OPTION_TOP,allIdentifyParams.width=map.width,allIdentifyParams.height=map.height,fatality_monthly_all_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/allFatalities_monthly/MapServer"),fatality_monthly_ped_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedFatalities_monthly/MapServer"),fatality_monthly_bike_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeFatalities_monthly/MapServer"),fatality_monthly_motor_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorFatalities_monthly/MapServer"),fatality_yearly_all_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/allFatalities_yearly/MapServer"),fatality_yearly_ped_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedFatalities_yearly/MapServer"),fatality_yearly_bike_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeFatalities_yearly/MapServer"),fatality_yearly_motor_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorFatalities_yearly/MapServer"),injury_monthly_all_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/all_monthly_Injuries_and_fatalities/MapServer"),injury_monthly_ped_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedFatalities_and_Injuries_monthly/MapServer"),injury_monthly_bike_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeFatalities_and_Injuries_monthly/MapServer"),injury_monthly_motor_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorFatalities_and_Injuries_monthly/MapServer"),injury_yearly_all_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/allInjury_yearly/MapServer"),injury_yearly_ped_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/pedInjury_yearly/MapServer"),injury_yearly_bike_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/bikeInjury_yearly/MapServer"),injury_yearly_motor_IdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/motorInjury_yearly/MapServer"),interventionIdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/SAFETY_INTERVENTION/MapServer"),outreachIdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/OUTREACH/MapServer"),summaryInjIdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/SUMMARY_2014_INJURIES/MapServer"),summaryFatalIdentifyTask=new esri.tasks.IdentifyTask("http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/SUMMARY_2014_FATALITIES/MapServer"),dojo.connect(map,"onClick",executeIdentifyTask),dojo.connect(map,"touchend",executeIdentifyTask)})}function executeIdentifyTask(a){var b,c=map.centerAt(a.mapPoint);c.addCallback(function(){if(injury){var c=map.getScale();if(c>64e3)alert("Please zoom in to view feature information");else{map.infoWindow.hide();var d;if(yearly){var e;b=$("#yearSelect").is(":visible")?smallScreenCrashLayer():$("#jqxslider2").jqxSlider("getValue"),d=7*b,allIdentifyParams.geometry=a.mapPoint,allIdentifyParams.layerIds=[d,d+1,d+2,d+3,d+4,d+5,d+6],allIdentifyParams.mapExtent=map.extent,all?e=injury_yearly_all_IdentifyTask.execute(allIdentifyParams):ped?e=injury_yearly_ped_IdentifyTask.execute(allIdentifyParams):motor?e=injury_yearly_motor_IdentifyTask.execute(allIdentifyParams):bike&&(e=injury_yearly_bike_IdentifyTask.execute(allIdentifyParams))}else if(monthly){var e;b=$("#monthSelect").is(":visible")?smallScreenCrashLayer():$("#jqxslider").jqxSlider("getValue"),d=8*b,allIdentifyParams.geometry=a.mapPoint,allIdentifyParams.layerIds=[d,d+1,d+2,d+3,d+4,d+5,d+6,d+7,d+8],allIdentifyParams.mapExtent=map.extent,all?e=injury_monthly_all_IdentifyTask.execute(allIdentifyParams):ped?e=injury_monthly_ped_IdentifyTask.execute(allIdentifyParams):motor?e=injury_monthly_motor_IdentifyTask.execute(allIdentifyParams):bike&&(e=injury_monthly_bike_IdentifyTask.execute(allIdentifyParams))}e.addCallback(function(c){return c.length>0?map.infoWindow.show(a.mapPoint):map.infoWindow.hide(),dojo.map(c,function(a){var c,d,e=a.feature,f=a.layerName;if(monthly?(c=f.split("_"),d=c[0]):yearly&&(c=f.charAt(3),d=c),monthly)var g=sliderLookup(b);else if(yearly)var g=slider2Lookup(b);var h;"injuries"==d||"I"==d?yearly?(h="<table><tr><td><b>Total Injuries: </b>&nbsp; </td><td>${Injuries}</td></tr></table>",h+="<table><tr><td><b>Non-Injury Crashes: </b>&nbsp;</td><td> ${NonInjuryCrashes}</td></tr></table>"):monthly&&(h="<table><tr><td><b>Total Injuries: </b>&nbsp; </td><td>  ${Injuries}</td></tr></table>",h+="<table><tr><td><b>Non-Injury Crashes: </b>&nbsp;  </td><td> ${NonInjuryCrashes}</td></tr></table>"):("fatalities"==d||"F"==d)&&(yearly?(h="<table><tr><td><b>Total Fatalities: </b></td><td>&nbsp;   ${Fatalities}</td></tr></table>",h+="<table><tr><td><b>Total Injuries: </b></td><td>&nbsp;   ${Injuries}</td></tr></table>",h+="<table><tr><td><b>Non-Injury Crashes: </b>&nbsp;  </td><td> ${NonInjuryCrashes}</td></tr></table>"):monthly&&(h="<table><tr><td><b>Total Fatalities: </b></td><td>&nbsp;   ${Fatalities}</td></tr></table>",h+="<table><tr><td><b>Total Injuries: </b></td><td>&nbsp;   ${Injuries}</td></tr></table>",h+="<table><tr><td><b>Non-Injury Crashes: </b></td><td>&nbsp;   ${NonInjuryCrashes}</td></tr></table>"));var i=new esri.InfoTemplate;return i.setTitle(g),i.setContent(h),e.setInfoTemplate(i),e})}),map.infoWindow.setFeatures([e])}}else if(fatality){var d;if(map.infoWindow.hide(),yearly){var e;b=$("#yearSelect").is(":visible")?smallScreenCrashLayer():$("#jqxslider2").jqxSlider("getValue"),d=4*b,allIdentifyParams.geometry=a.mapPoint,allIdentifyParams.layerIds=[d,d+1,d+2,d+3],allIdentifyParams.mapExtent=map.extent,all?e=fatality_yearly_all_IdentifyTask.execute(allIdentifyParams):ped?e=fatality_yearly_ped_IdentifyTask.execute(allIdentifyParams):motor?e=fatality_yearly_motor_IdentifyTask.execute(allIdentifyParams):bike&&(e=fatality_yearly_bike_IdentifyTask.execute(allIdentifyParams))}else if(monthly){var e;b=$("#monthSelect").is(":visible")?smallScreenCrashLayer():$("#jqxslider").jqxSlider("getValue"),d=4*b,allIdentifyParams.geometry=a.mapPoint,allIdentifyParams.layerIds=[d,d+1,d+2,d+3],allIdentifyParams.mapExtent=map.extent,console.log("month "+allIdentifyParams.layerIds),all?e=fatality_monthly_all_IdentifyTask.execute(allIdentifyParams):ped?e=fatality_monthly_ped_IdentifyTask.execute(allIdentifyParams):motor?e=fatality_monthly_motor_IdentifyTask.execute(allIdentifyParams):bike&&(e=fatality_monthly_bike_IdentifyTask.execute(allIdentifyParams))}e.addCallback(function(c){return c.length>0?map.infoWindow.show(a.mapPoint):map.infoWindow.hide(),dojo.map(c,function(a){var c=a.feature;if(monthly)var d=sliderLookup(b);else if(yearly)var d=slider2Lookup(b);var e;yearly?(e="<table><tr><td><b>Total Fatalites: </b>&nbsp; </td><td> ${Fatalities}</td></tr></table>",e+="<table><tr><td><b>Non-Injury Crashes: </b>&nbsp; </td><td> ${NonInjuryCrashes}</td></tr></table>"):monthly&&(e="<table><tr><td><b>Total Fatalites: </b>&nbsp; </td><td> ${Fatalities}</td></tr></table>",e+="<table><tr><td><b>Non-Injury Crashes: </b>&nbsp; </td><td> ${NonInjuryCrashes}</td></tr></table>");var f=new esri.InfoTemplate;return f.setTitle(d),f.setContent(e),c.setInfoTemplate(f),c})}),map.infoWindow.setFeatures([e])}else if(interventions){var e;allIdentifyParams.geometry=a.mapPoint,allIdentifyParams.layerIds=[interventionLayerIDs],allIdentifyParams.mapExtent=map.extent,e=interventionIdentifyTask.execute(allIdentifyParams),e.addCallback(function(b){return b.length>0?map.infoWindow.show(a.mapPoint):map.infoWindow.hide(),dojo.map(b,function(a){var b=a.feature,c=a.layerName;console.log("layername"+c);var d=new esri.InfoTemplate;switch(c){case"ASZ_Final_Dissolve":locTxt="<table><tr><td><b>Corridor: </b>${CORRIDOR}</td></tr>",locTxt+="<tr><td>From&nbsp;${FROM_STREET}",locTxt+=" To&nbsp;${TO_STREET}</td></tr></table>",d.setTitle("Arterial Slow Zones");break;case"Safe_Streets_For_Seniors_preVZ":locTxt="<table><tr><td><b>Name:</b>&nbsp; ${Name}</td></tr>",locTxt+="<tr><td><b>Year:</b>&nbsp;   ${Year}</td></tr></table>",d.setTitle("Safe Streets For Seniors");break;case"Neighborhood_Slow_Zones_pre_post_VZ":locTxt="<table><tr><td><b>Name:&nbsp; </b>${Name}</td></tr>",locTxt+="<tr><td><b>Year:</b>&nbsp; ${Year}</td></tr></table>",d.setTitle("Neighborhood Slow Zones");break;case"SAFETY_ENGG_SIP_Corridors":case"SAFETY_ENGG_SIP_Intersections":locTxt="<table><tr><td><b>Project Name:&nbsp;</b>${Pjct_Name}</td></tr>",locTxt+="<tr><td><b>Project Type:</b>&nbsp;${SIPProjTyp}</td></tr></table>",d.setTitle("Safety Engineering Projects");break;case"sb_2014Dissolve_0725":locTxt="<table><tr><td><b>On Street:&nbsp; </b>${FIRST_Main}</td></tr>",locTxt+="<tr><td>From&nbsp; ${FIRST_From}",locTxt+=" To&nbsp;${FIRST_ToSt}</td></tr>",locTxt+="<tr><td><b>Date Installed:</b> &nbsp;${Date_installed}</td></tr>",locTxt+="<tr><td><b>Num. of Humps:</b> &nbsp;${Num_speedhumps}</td></tr></table>",d.setTitle("Speed Humps");break;case"LPI":locTxt="<table><tr><td><b>Main Street:&nbsp; </b>${MainStreet}</td></tr>",locTxt+="<tr><td><b>Cross Street:</b>&nbsp; ${CrossStree}</td></tr></table>",d.setTitle("Leading Pedestrian Signals");break;default:locTxt="No data available"}return d.setContent(locTxt),b.setInfoTemplate(d),b})}),map.infoWindow.setFeatures([e])}else if(outreach){var e;allIdentifyParams.geometry=a.mapPoint,allIdentifyParams.layerIds=[outreachLayerIDs],allIdentifyParams.mapExtent=map.extent,e=outreachIdentifyTask.execute(allIdentifyParams),e.addCallback(function(b){return b.length>0?map.infoWindow.show(a.mapPoint):map.infoWindow.hide(),dojo.map(b,function(a){var b=a.feature,c=a.layerName,d=new esri.InfoTemplate;switch(c){case"Outreach_schools":locTxt="<table><tr><td><b>School: </b>&nbsp;${SiteServed}</td></tr>",locTxt+="<tr><td><b>Activity:</b> &nbsp; ${Activity}</td></tr>",locTxt+="<tr><td><b>Event Date:</b> &nbsp;${EventDate}</td></tr>",d.setTitle("School Outreach Events");break;case"TownHallLocations":locTxt="<table><tr><td><b>Location: </b>&nbsp;${Sheet1__NA}</td></tr>",locTxt+="<tr><td><b>Address:</b>&nbsp; ${Sheet1__AD}</td></tr></table>",d.setTitle("Town Halls");break;case"workshop_locations":locTxt="<table><tr><td><b>Location:&nbsp; </b>${Sheet1__Na}</td></tr>",locTxt+="<tr><td><b>Year:</b>&nbsp; ${Sheet1__AD}</td></tr></table>",d.setTitle("Workshops");break;case"Senior_Centers":locTxt="<table><tr><td><b>Location:&nbsp;</b>${Site_Serve}</td></tr>",locTxt+="<tr><td><b>Event:&nbsp; </b>${Activity}</td></tr>",locTxt+="<tr><td><b>Event Date:&nbsp; </b>${EventDate}</td></tr></table>",d.setTitle("Senior Centers");break;case"tlc":locTxt="<table><tr><td><b>Location:&nbsp;</b>${Title}</td></tr>",locTxt+="<tr><td><b>Address:&nbsp;</b>${Location}</td></tr></table>",d.setTitle("TLC");break;default:locTxt="No data available"}return d.setContent(locTxt),b.setInfoTemplate(d),b})}),map.infoWindow.setFeatures([e])}else if(injurySum||fatalitySum){var e;allIdentifyParams.geometry=a.mapPoint,allIdentifyParams.layerIds=[summaryLayerIDs],allIdentifyParams.mapExtent=map.extent,injurySum&&(e=summaryInjIdentifyTask.execute(allIdentifyParams)),fatalitySum&&(e=summaryFatalIdentifyTask.execute(allIdentifyParams)),e.addCallback(function(b){return b.length>0?map.infoWindow.show(a.mapPoint):map.infoWindow.hide(),dojo.map(b,function(a){var b=a.feature,c=a.layerName,d=new esri.InfoTemplate;switch(c){case"Summary_2014_PP_ALL_FATALITIES":case"Summary_2014_PP_ALL_INJURIES":locTxt="<table><tr><td><b>PRECINCT: </b>&nbsp;</td><td>${Precinct}</td></tr>",d.setTitle("Police Precinct Summary: 2014 YTD");break;case"Summary_2014_CD_ALL_FATALITIES":case"Summary_2014_CD_ALL_INJURIES":locTxt="<table><tr><td><b>COMMUNITY DISTRICT: </b>&nbsp;</td><td>${BoroCD}</td></tr>",d.setTitle("Community District Summary: 2014 YTD");break;case"Summary_2014_CC_ALL_FATALITIES":case"Summary_2014_CC_ALL_INJURIES":locTxt="<table><tr><td><b>COUNCIL DISTRICT: </b>&nbsp;</td><td>${CounDist}</td></tr>",d.setTitle("City Council Summary: 2014 YTD")
}return locTxt+="<tr><td><b><h4>CRASH DATA</h4></b></td></tr>",locTxt+="<tr><td><b>Total fatalites:</b>&nbsp; </td><td>${SUM_Fatalities}</td></tr>",locTxt+="<tr><td><b>Total Injuries:</b>&nbsp; </td><td>${SUM_Injuries}</td></tr>",locTxt+="<tr><td><b>Pedestrian Fatalites:</b>&nbsp; </td><td>${SUM_PedFatalities}</td></tr>",locTxt+="<tr><td><b>Pedestrian Injuries:</b>&nbsp;  </td><td>${SUM_PedInjuries}</td></tr>",locTxt+="<tr><td><b>Bicycle Fatalites:</b>&nbsp; </td><td> ${SUM_BikeFatalities}</td></tr>",locTxt+="<tr><td><b>Bicycle Injuries:</b>&nbsp; </td><td> ${SUM_BikeInjuries}</td></tr>",locTxt+="<tr><td><b>Motorist Fatalites:</b> &nbsp; </td><td>${SUM_MVOFatalities}</td></tr>",locTxt+="<tr><td><b>Motorist Injuries:</b>&nbsp; </td><td>${SUM_MVOInjuries}</td></tr>",locTxt+="<tr><td><b>Non-Injury Crashes:</b>&nbsp; </td><td>${SUM_nonInj_Crashes}</td></tr>",locTxt+="<tr><td><b><h4>DEMOGRAPHIC DATA</h4></b></td></tr>",locTxt+="<tr><td><b>Total Population:</b>&nbsp; </td><td>${TotalPop}</td></tr>",locTxt+="<tr><td><b>Age Under 5:</b>&nbsp; </td><td>${Ages_Under5}</td></tr>",locTxt+="<tr><td><b>Age 5-9:</b>&nbsp; </td><td>${Ages_5to9}</td></tr>",locTxt+="<tr><td><b>Age 10-14:</b>&nbsp;  </td><td>${Ages_10to14}</td></tr>",locTxt+="<tr><td><b>Age 15-19:</b>&nbsp; </td><td> ${Ages_15to19}</td></tr>",locTxt+="<tr><td><b>Age 20-24:</b>&nbsp; </td><td> ${Ages_20to24}</td></tr>",locTxt+="<tr><td><b>Age 25-44:</b> &nbsp; </td><td>${Ages_25to44}</td></tr>",locTxt+="<tr><td><b>Age 45-64:</b>&nbsp; </td><td>${Ages_45to64}</td></tr>",locTxt+="<tr><td><b>Age 65 And Over:</b>&nbsp; </td><td>${Ages_65andOver}</td></tr>",locTxt+="<tr><td><b>Age 18 And Over:</b>&nbsp; </td><td>${Ages_18andOver}</td></tr></table>",d.setContent(locTxt),b.setInfoTemplate(d),b})}),map.infoWindow.setFeatures([e])}map.infoWindow.resize(270,180)})}function sliderSetup(){function a(){var a=$("<div />");return $(document.body).append(a),a.css("visibility","hidden"),a.fadeTo(0,2),a.addClass("jqx-rc-all"),a.addClass("tooltip"),a}function b(a){var b=$($("#jqxslider").find(".jqx-slider-slider")[1]),c=b.offset().left,e=b.offset().top;d.css("left",c-(d.outerWidth(!0)-b.outerWidth(!0))/2),d.css("top",e-d.outerHeight(!0)-25);var f=sliderLookup(a);$("#dateLabel").text(f),$("#date2Label").text(f),d.text(f)}var c=$($("#jqxslider").find(".jqx-slider-slider")[1]),d=a(),e=!0;c.bind("mousedown",function(){d.css("visibility","hidden"),b($("#jqxslider").jqxSlider("value")),e=!0}),$(document).bind("mousemove",function(){e&&b($("#jqxslider").jqxSlider("value"))}),$(document).bind("mouseup",function(){d.css("visibility","hidden"),e=!1})}function sliderLookup(a){var b,c,d=a%12,e=parseInt(a/12);switch(d){case 0:b="Jan";break;case 1:b="Feb";break;case 2:b="March";break;case 3:b="Apr";break;case 4:b="May";break;case 5:b="June";break;case 6:b="July";break;case 7:b="Aug";break;case 8:b="Sept";break;case 9:b="Oct";break;case 10:b="Nov";break;case 11:b="Dec";break;default:b="Jan"}switch(e){case 0:c="2009";break;case 1:c="2010";break;case 2:c="2011";break;case 3:c="2012";break;case 4:c="2013";break;case 5:c="2014";break;default:c="2009"}var f=b+" "+c;return f}function slider2Lookup(a){var b;switch(a){case 0:b="2009";break;case 1:b="2010";break;case 2:b="2011";break;case 3:b="2012";break;case 4:b="2013";break;case 5:b="2014 YTD";break;default:b="2009"}return b}function showLoading(){$("#loadingImg").show()}function hideLoading(){$("#loadingImg").hide()}function hideSlider(){$("#sliderDiv").hide()}function showSlider(){$("#sliderDiv").show(),$("#sliderDiv").css("opacity",1)}function CategoryNav(a){map.infoWindow.hide();var b,c;"summaryCat"==a?(b="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/SUMMARY_2014_INJURIES/MapServer",c="summaryInjuryLayer",summaryInjuryLayer=AddDynamicLayer(b,c,!0),b="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/SUMMARY_2014_FATALITIES/MapServer",c="summaryFatalityLayer",summaryFatalityLayer=AddDynamicLayer(b,c,!0),console.log("injurSum = "+injurySum+"    fatalitySum = "+fatalitySum),injurySum?(summaryInjuryLayer.setVisibility(!0),summaryFatalityLayer.setVisibility(!1)):fatalitySum&&(summaryInjuryLayer.setVisibility(!1),summaryFatalityLayer.setVisibility(!0)),$("#sliderDiv").css("display","none"),$("#jqxslider").css("display","none"),$("#jqxslider2").css("display","none"),$("#labelDiv").css("display","none"),$("#date3Label").css("display","none"),fatality=!1,injury=!1,monthly=!1,yearly=!1,setTimeout(function(){checkSummaryBtns(summaryLayerIDs)},20)):"interventionCat"==a?(b="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/SAFETY_INTERVENTION/MapServer",c="interventionLayer",interventionLayer=AddDynamicLayer(b,c,!0),interventions=!0,interventionLayerIDs=[],setTimeout(function(){checkInterventionBtns(interventionLayerIDs)},30),$("#sliderDiv").css("display","none"),$("#jqxslider").css("display","none"),$("#jqxslider2").css("display","none"),$("#labelDiv").css("display","none"),$("#date3Label").css("display","none")):"outreachCat"==a?(b="http://"+arcgisserver+"/arcgis/rest/services/VISION_ZERO/OUTREACH/MapServer",c="outreachLayer",outreachLayer=AddDynamicLayer(b,c,!0),outreach=!0,outreachLayerIDs=[],setTimeout(function(){checkOutreachBtns(outreachLayerIDs)},30),$("#sliderDiv").css("display","none"),$("#jqxslider").css("display","none"),$("#jqxslider2").css("display","none"),$("#labelDiv").css("display","none"),$("#date3Label").css("display","none")):"injuryCat"==a&&(checkCrashCatState(),$("#sliderDiv").css("display","block"),$("#labelDiv").css("display","block"),$("#date3Label").css("display","block"),monthly?($("#jqxslider").css("display","block"),$("#jqxslider2").css("display","none")):yearly&&($("#jqxslider2").css("display","block"),$("#jqxslider").css("display","none")))}function removeLayer(){var a=map.getLayer("outreachLayer"),b=map.getLayer("interventionLayer"),c=map.getLayer("referenceLayer"),d=map.getLayer("summaryInjuryLayer"),e=map.getLayer("summaryFatalityLayer");a&&map.removeLayer(a),b&&map.removeLayer(b),c&&map.removeLayer(c),d&&map.removeLayer(d),e&&map.removeLayer(e)}function allLayersOff(){fatality=!1,injury=!1,monthly=!1,yearly=!1,interventions=!1,outreach=!1}function disableCatButtons(){$("#injuryCat").attr("disabled","disabled"),$("#interventionCat").attr("disabled","disabled"),$("#outreachCat").attr("disabled","disabled"),$("#summaryCat").attr("disabled","disabled")}function enableCatButtons(){$("#injuryCat").removeAttr("disabled"),$("#interventionCat").removeAttr("disabled"),$("#outreachCat").removeAttr("disabled"),$("#summaryCat").removeAttr("disabled")}function resizeMap(){curWidth=$(window).width(),curDocWidth=$(document).width(),console.log("map resize");var a=$("#navbarDIV").outerHeight(!0),b=$("#blackBar").outerHeight(!0),c=$("#footer").outerHeight(!0),d=$("#sidebar").outerHeight(!0),e=a+b+c;if($("#map").height(f),767>curWidth||767>curDocWidth)var f=window.innerHeight;else var f=window.innerHeight-e-15;if($("#map").height(f),map&&""==window.location.hash){var f=window.innerHeight-e-15;console.log("sidebar "+d),console.log("Map Height "+f),$("#map").height(f>d?f:d),map.reposition(),map.resize()}}function orientationChanged(a){switch(a){case-90:case 90:}map&&resizeMap()}function mapWinEvent(){var a="orientationchange"in window,b=a?"orientationchange":"resize";window.addEventListener(b,function(){orientationChanged(window.orientation)},!1),window.addEventListener("resize",function(){map&&resizeMap()},!1)}function checkInterventionBtns(a){if(hasClass("ASZBtn","active")){var b=3;a.push(b)}if(hasClass("SSFSBtn","active")){var b=5;a.push(b)}if(hasClass("slowZonesBtn","active")){var b=6;a.push(b)}if(hasClass("engineeringBtn","active")){var b=1,c=2;a.push(b,c)}if(hasClass("speedHumpsBtn","active")){var b=4;a.push(b)}if(hasClass("LPIBtn","active")){var b=0;a.push(b)}interventionLayer.setVisibleLayers(a)}function checkOutreachBtns(a){if(hasClass("SchoolBtn","active")){console.log("School checked");var b=0;a.push(b),$("#Schools").prop("checked","checked")}if(hasClass("SeniorBtn","active")){var b=1;a.push(b),console.log("seniors added")}if(hasClass("TLCBtn","active")){var b=2;a.push(b),console.log("tlc added")}if(hasClass("TownHallBtn","active")){var b=3;a.push(b),console.log("townhall added")}if(hasClass("WorkshopBtn","active")){var b=4;a.push(b),console.log("workshops added")}outreachLayer.setVisibleLayers(a)}function hasClass(a,b){if(isIE()){for(var c=document.getElementById(a).className.split(/\s+/),d=0;d<c.length;d++)if(c[d]==b)return!0;return!1}return $("#"+a).hasClass(b)}function checkSummaryLegend(){injurySum?(police?$("#injurySumLegendType").text("Police Precinct"):community?$("#injurySumLegendType").text("Community District"):council&&$("#injurySumLegendType").text("City Council District"),$("#injurySumLegend").css("display","block"),$("#fatalitySumLegend").css("display","none")):fatalitySum&&(police?$("#fatalSumLegendType").text("Police Precinct"):community?$("#fatalSumLegendType").text("Community District"):council&&$("#fatalSumLegendType").text("City Council District"),$("#injurySumLegend").css("display","none"),$("#fatalitySumLegend").css("display","block"))}function checkSummaryBtns(a){console.log("check"),a.length=0,police?a.push(0):community?a.push(1):council&&a.push(2),injurySum?(console.log("get here?"),summaryInjuryLayer.setVisibility(!0),summaryFatalityLayer.setVisibility(!1),summaryInjuryLayer.setVisibleLayers(a)):fatalitySum&&(summaryInjuryLayer.setVisibility(!1),summaryFatalityLayer.setVisibility(!0),summaryFatalityLayer.setVisibleLayers(a)),checkSummaryLegend(),console.log(a)}function zoomTo(a,b){require(["esri/geometry/Point","esri/geometry/webMercatorUtils","esri/graphic"],function(c,d,e){map.graphics.clear();var f=new c(b,a);console.log(f);var g=(d.geographicToWebMercator(f),f.x-3e3),h=f.y-3e3,i=f.x+3e3,j=f.y+3e3,k=new esri.geometry.Extent(g,h,i,j,map.spatialReference);map.setExtent(k);var l=new e(f,symbol,gslocation,infoTemplate);map.graphics.add(l),map.infoWindow.setTitle(l.getTitle()),map.infoWindow.setContent(l.getContent());var m=map.toScreen(f);map.infoWindow.resize(200,100),map.infoWindow.show(m,map.getInfoWindowAnchor(m))})}function LocationSearch(){$("#btnsearch").on(evt,function(){var a=$("#searchBorough").text().trim(),b=$("#address").val();GeoParser(b,a)})}function GeoParser(a,b){return"Borough"==b?void alert("Please select borough"):void("Police Precinct"==b?GetPrecinct(a):"Zip Code"==b?GetZip(a):"Community District"==b?GetCD(a):"City Council District"==b?GetCityCouncil(a):GetGeoSupportJSON(a,b))}function GetGeoSupportJSON(a,b){var c=toTitleCase(a+" "+b);gslocation.location=c,$.getJSON("https://api.cityofnewyork.us/geoclient/v1/search.json?callback=?&app_id=d72f9ac0&app_key=d1d9ba774e1bc021c256c3e53752adc4&returnPolicy=true&returnPossiblesWithExact=true&returnRejections=true&returnTokens=true&input="+c,function(a){0==a.results.length&&alert("No match to location entered."),"OK"==a.status&&processGSResult(a),"REJECTED"==a.status&&processGSReject(a)})}function processGSResult(a){$.each(a.results,function(a,b){return"EXACT_MATCH"==b.status?(console.log(b.response.xCoordinate,b.response.yCoordinate),gslocation.lon=parseFloat(b.response.xCoordinate),gslocation.lat=parseFloat(b.response.yCoordinate),console.log(gslocation),zoomTo(gslocation.lat,gslocation.lon),!1):"POSSIBLE_MATCH"==b.status?(console.log(b.request),alert("Location not found. Did you mean: \n"+SimplifyResponse(b.request)),!1):void 0})}function SimplifyResponse(a){var b,c,d=a.indexOf("["),e=a.indexOf("]"),f=a.substr(d+1,e-d-1),g=f.split(",");c="";for(var h=0;h<g.length;h++)b=g[h].split("="),"null"!=b[1]&&(c+=b[1]+" ");return c}function processGSReject(a){$.each(a.results,function(a,b){return console.log(b.response.message),console.log(b.response.message2),alert(b.response.message),!1})}function toTitleCase(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}function GetCD(a){queryTask=new esri.tasks.QueryTask("http://www.nycdot.info:6080/arcgis/rest/services/GISAPP_GAZETTEER/NYCDOTBasemapAdminBoundaries/MapServer/1"),query=new esri.tasks.Query,query.returnGeometry=!0,query.outFields=["BoroCD"],map.infoWindow.hide(),map.graphics.clear(),query.where="BoroCD  = "+a,queryTask.execute(query,function(a){1===a.features.length&&showFeature(a.features[0])})}function GetZip(){query=new esri.tasks.Query,query.returnGeometry=!0,query.outFields=["BoroCD"],map.infoWindow.hide(),map.graphics.clear(),query.where="BoroCD  = "+cd,queryTask.execute(query,function(a){1===a.features.length&&showFeature(a.features[0])})}function GetPrecinct(a){queryTask=new esri.tasks.QueryTask("http://www.nycdot.info:6080/arcgis/rest/services/GISAPP_GAZETTEER/NYCDOTBasemapAdminBoundaries/MapServer/4"),query=new esri.tasks.Query,query.returnGeometry=!0,query.outFields=["Precinct"],map.infoWindow.hide(),map.graphics.clear(),query.where="Precinct  = "+a,queryTask.execute(query,function(a){1===a.features.length&&showFeature(a.features[0])})}function GetCityCouncil(a){queryTask=new esri.tasks.QueryTask("http://www.nycdot.info:6080/arcgis/rest/services/GISAPP_GAZETTEER/NYCDOTBasemapAdminBoundaries/MapServer/0"),query=new esri.tasks.Query,query.returnGeometry=!0,query.outFields=["CounDist"],map.infoWindow.hide(),map.graphics.clear(),query.where="CounDist  = "+a,queryTask.execute(query,function(a){1===a.features.length&&showFeature(a.features[0])})}function showFeature(a){map.graphics.clear(),a.setSymbol(fillSymbol),map.graphics.add(a);var b=a.geometry.getExtent().expand(5);map.setExtent(b),hideLoading()}function showResults(a){var b=esri.graphicsExtent(a.features);map.setExtent(b.expand(1.5),!0)}function wktToEsriGeometry(a){if("POLYGON"==a.substring(0,7)){var b='{"rings":[[',c=a.split(",");c[0]=c[0].replace("POLYGON ((","");var d=c.length-1;c[d]=c[d].replace("))","");for(var e=0;d>=e;e++)" "==c[e].charAt(0)&&(c[e]=c[e].slice(1)),c[e]=c[e].replace(" ",","),b+="[",b+=c[e],b+=d>e?"],":"]";b+=']],"spatialReference":{"wkid":2263}}';var f=JSON.parse(b),g=new esri.geometry.Polygon(f);return g}if("LINESTRING"==a.substring(0,10)){var h='{"paths":[[',c=a.split(",");c[0]=c[0].replace("LINESTRING (","");var d=c.length-1;c[d]=c[d].replace(")","");for(var e=0;d>=e;e++)" "==c[e].charAt(0)&&(c[e]=c[e].slice(1)),c[e]=c[e].replace(" ",","),h+="[",h+=c[e],h+=d>e?"],":"]";h+=']], "spatialReference": { "wkid": 2263 }}';var i=JSON.parse(h),j=new esri.geometry.Polyline(i);return j}if("POINT"==a.substring(0,5)){a=a.replace("POINT (",""),a=a.replace(")",""),a=a.replace(" ",",");var c=a.split(","),k=new esri.geometry.Point(c,new esri.SpatialReference({wkid:2263}));return k}}function getCurrentLocation(){return showLoading(),navigator.geolocation?(navigator.geolocation.getCurrentPosition(addGeolocationMarker,locationError),!0):(alert("Browser doesn't support Geolocation. Visit http://caniuse.com to discover browser support for the Geolocation API."),firstView=!1,!1)}function addGeolocationMarker(a){var b="POLYGON ((913353.48495726287 120189.72554992139, 916779.94759251177 118476.49439634383, 930771.33660441637 123616.18818517029, 947903.64978067577 132467.88340824842, 961895.03912067413 145031.57973749936, 983024.89187400043 144746.04126659036, 996445.203944087 145888.19547833502, 1001299.3595900834 138178.65446700156, 1040418.1412605047 151598.96653708816, 1057550.4544367641 155025.42917233706, 1057835.9929076731 169587.89545416832, 1056979.3774949163 173585.43503125012, 1061547.9943419248 176440.82072466612, 1061262.455542922 186720.20863042772, 1061262.455542922 191859.90274733305, 1060405.8401301801 202139.29065309465, 1066116.6111889184 203281.44486483932, 1068400.9196124226 208421.13865366578, 1068400.9196124226 212989.75550067425, 1052981.8375897557 225838.99062892795, 1050697.5291662514 221270.37378191948, 1048698.7592136711 225838.99062892795, 1047842.1438009292 229265.45326417685, 1043273.5269539207 232977.45437033474, 1050411.9906953424 250109.76754659414, 1045557.835377425 258390.38549976051, 1041845.8339431733 261816.84813500941, 1028996.5991430134 265243.31077025831, 1028996.5991430134 268955.31220451, 1024713.5207669288 271525.15909892321, 1022143.6738725007 268098.69646367431, 1008437.8233315051 273238.39025250077, 1003869.2064845115 260960.23272225261, 998729.51236759126 249538.69060476124, 997872.8966267556 244113.45801691711, 981051.616621092 214203.29441216588, 978494.88124901056 196424.14886817336, 972634.05668458343 194732.77003309131, 971768.69981950521 193513.40403351188, 963893.8087451756 177011.89766649902, 942192.87872192264 174156.51230117679, 934768.87650959194 176155.28225375712, 929343.6439217627 173014.35808941722, 914495.63916900754 138178.65446700156, 912211.33074550331 124187.26545508206, 913353.48495726287 120189.72554992139))";nycPolygon=wktToEsriGeometry(b),pt=new esri.geometry.Point(a.coords.longitude,a.coords.latitude,new esri.SpatialReference({wkid:4326}));var c=new esri.SpatialReference({wkid:2263}),d=new esri.tasks.GeometryService("http://"+arcgisserver+"/ArcGIS/rest/services/Geometry/GeometryServer");d.project([pt],c,function(a){if(nycPolygon.contains(a[0])){geoGraphic?geoGraphic.setGeometry(a[0]):addGeoGraphic(a[0]);var b=a[0].x-3e3,c=a[0].y-3e3,d=a[0].x+3e3,e=a[0].y+3e3,f=new esri.geometry.Extent(b,c,d,e,map.spatialReference);return map.setExtent(f),hideLoading(),!0}return alert("Your location is outside of the City of New York city limits. This application is for NYC Data only."),hideLoading(),!1})}function locationError(a){switch(firstView=!1,a.code){case a.PERMISSION_DENIED:alert("Location Services: Location not provided. Check your browser settings.");break;case a.POSITION_UNAVAILABLE:alert("Location Services: Current location not available");break;case a.TIMEOUT:alert("Location Services: Timeout");break;default:alert("Location Services: Unknown Error")}hideLoading()}function addGeoGraphic(a){var b=new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,255,.5]),8),new dojo.Color([0,0,255,.9]));geoGraphic=new esri.Graphic(a,b,map.spatialReference),map.graphics.add(geoGraphic)}function checkStats(){var a=$("#monthSelect").val(),b=$("#yearSelect").val();if(selectMonthVal=parseInt(a),selectYearVal=parseInt(b),$("#yearSelect").is(":visible")){var c;c=smallScreenCrashLayer(),c>=67?($("#stat1Mobile").text("Data not yet available"),$("#stat2Mobile").text("")):setStats(c)}else if(monthly){var c;c=$("#jqxslider").jqxSlider("getValue"),setStats(c)}else if(yearly){var c;c=$("#jqxslider2").jqxSlider("getValue"),setStats(c)}}function setStats(a){monthly?ped?($("#stat1").text("Pedestrian Fatalities: "+stats[a].SUM_PedFat),$("#stat2").text("Pedestrian Injuries: "+commaSeparateNumber(stats[a].SUM_PedInj)),$("#stat1Mobile").text("Pedestrian Fatalities: "+stats[a].SUM_PedFat),$("#stat2Mobile").text("Pedestrian Injuries: "+commaSeparateNumber(stats[a].SUM_PedInj))):bike?($("#stat1").text("Cyclist Fatalities: "+stats[a].SUM_BikeFat),$("#stat2").text("Cyclist Injuries: "+commaSeparateNumber(stats[a].SUM_BikeInj)),$("#stat1Mobile").text("Cyclist Fatalities: "+stats[a].SUM_BikeFat),$("#stat2Mobile").text("Cyclist Injuries: "+commaSeparateNumber(stats[a].SUM_BikeInj))):motor?($("#stat1").text("Motorist Fatalities: "+stats[a].SUM_MVOFat),$("#stat2").text("Motorist Injuries: "+commaSeparateNumber(stats[a].SUM_MVOInj)),$("#stat1Mobile").text("Motorist Fatalities: "+stats[a].SUM_MVOFat),$("#stat2Mobile").text("Motorist Injuries: "+commaSeparateNumber(stats[a].SUM_MVOInj))):all&&console.log(a):yearly&&(ped?($("#stat1").text("Pedestrian Fatalities: "+stats2[a].SUM_PedFat),$("#stat2").text("Pedestrian Injuries: "+commaSeparateNumber(stats2[a].SUM_PedInj)),$("#stat1Mobile").text("Pedestrian Fatalities: "+stats2[a].SUM_PedFat),$("#stat2Mobile").text("Pedestrian Injuries: "+commaSeparateNumber(stats2[a].SUM_PedInj))):bike?($("#stat1").text("Cyclist Fatalities: "+stats2[a].SUM_BikeFat),$("#stat2").text("Cyclist Injuries: "+commaSeparateNumber(stats2[a].SUM_BikeInj)),$("#stat1Mobile").text("Cyclist Fatalities: "+stats2[a].SUM_BikeFat),$("#stat2Mobile").text("Cyclist Injuries: "+commaSeparateNumber(stats2[a].SUM_BikeInj))):motor?($("#stat1").text("Motorist Fatalities: "+stats2[a].SUM_MVOFat),$("#stat2").text("Motorist Injuries: "+commaSeparateNumber(stats2[a].SUM_MVOInj)),$("#stat1Mobile").text("Motorist Fatalities: "+stats2[a].SUM_MVOFat),$("#stat2Mobile").text("Motorist Injuries: "+commaSeparateNumber(stats2[a].SUM_MVOInj))):all&&($("#stat1").text("All Fatalities: "+stats2[a].SUM_Fatalities),$("#stat2").text("All Injuries: "+commaSeparateNumber(stats2[a].SUM_Injuries)),$("#stat1Mobile").text("All Fatalities: "+stats2[a].SUM_Fatalities),$("#stat2Mobile").text("All Injuries: "+commaSeparateNumber(stats2[a].SUM_Injuries))))}function commaSeparateNumber(a){a=a.toString().replace(/,/g,"");for(var b=a.split(".");/(\d+)(\d{3})/.test(b[0].toString());)b[0]=b[0].toString().replace(/(\d+)(\d{3})/,"$1,$2");return a=2==b.length?b[0]+"."+b[1]:b[0]}function smallScreenCrashLayer(){if(monthly)var a=12*selectYearVal+selectMonthVal;else if(yearly)var a=selectYearVal;return a}$(".btn-toggle").click(function(){$(this).find(".btn").toggleClass("active"),$(this).find(".btn-primary").size()>0&&$(this).find(".btn").toggleClass("btn-primary"),$(this).find(".btn-danger").size()>0&&$(this).find(".btn").toggleClass("btn-danger"),$(this).find(".btn-success").size()>0&&$(this).find(".btn").toggleClass("btn-success"),$(this).find(".btn-info").size()>0&&$(this).find(".btn").toggleClass("btn-info"),$(this).find(".btn").toggleClass("btn-default")}),$(".dropdown-menu li a").on(evt,function(){var a=$(this).text();$(this).parents(".input-group").find(".dropdown-toggle").html(a+' <span class="caret"></span>')});var dummy=document.getElementById("dummy");dummy.innerHTML="<!--[if lte IE 8]>x<![endif]-->";var isIE9="x"===dummy.innerHTML;1==isIE9&&alert("This website is designed for IE9 or higher.  Please update IE, or open the website using Chrome, Firefox, or another modern browser."),$("[data-toggle=dropdown]").each(function(){this.addEventListener("click",function(){},!1)}),$("#searchInput").on("keypress",function(a){13==a.keyCode&&"textarea"!=a.target.type&&(a.preventDefault(),$(this).trigger("submit"))}),$("#searchInput1").on("keypress",function(a){13==a.keyCode&&"textarea"!=a.target.type&&(a.preventDefault(),$(this).trigger("submit"))}),$(document).ready(function(){$(".crashTypeSwitchBtns").on(evt,function(){map.infoWindow.hide(),setTimeout(function(){$("#injuriesBtn").hasClass("active")?(injury=!0,fatality=!1,$("#fatalitiesBtn").css("color","#777"),$("#injuriesBtn").css("color","#FFF")):$("#fatalitiesBtn").hasClass("active")&&(injury=!1,fatality=!0,$("#injuriesBtn").css("color","#777"),$("#fatalitiesBtn").css("color","rgb(255,255,255)")),toggleCrashLayers()},20)})}),$(document).ready(function(){$(".crashTimeSwitchBtns").on(evt,function(){map.infoWindow.hide(),setTimeout(function(){$("#monthlyBtn").hasClass("active")?(monthly=!0,yearly=!1,$("#yearlyBtn").css("color","#777"),$("#monthlyBtn").css("color","rgb(255,255,255)")):$("#yearlyBtn").hasClass("active")&&(monthly=!1,yearly=!0,$("#monthlyBtn").css("color","#777"),$("#yearlyBtn").css("color","rgb(255,255,255)")),toggleCrashLayers()},20)})}),$(document).ready(function(){all=!0,$(".crashTypes").on(evt,function(){map.infoWindow.hide(),$(".crashTypes").css("background-color","rgb(255,255,255)"),$(".crashTypes").css("color","#777"),$(this).css("background-color","#3276b1"),$(this).css("color","white");var a=$(this).find("input").attr("id");switch(a){case"ped":ped=!0,bike=!1,motor=!1,all=!1;break;case"motor":ped=!1,bike=!1,motor=!0,all=!1;break;case"bike":ped=!1,bike=!0,motor=!1,all=!1;break;case"all":ped=!1,bike=!1,motor=!1,all=!0;break;default:all=!0}toggleCrashLayers()})}),$(document).ready(function(){$("#sliderDiv").css("display","none"),$("#jqxslider").jqxSlider({theme:"bootstrap",value:0,min:0,max:64,mode:"fixed",step:1,ticksFrequency:1,tooltip:!1});for(var a=$("#jqxslider .jqx-slider-tickscontainer:eq(0)").children(),b=$("#jqxslider .jqx-slider-tickscontainer:eq(1)").children(),c=0;c<a.length;c++)c%12!=0&&$(b[c]).css("display","none");$("#sliderDiv").css("display","block")}),$(document).ready(function(){$("#jqxslider2").jqxSlider({theme:"bootstrap",value:0,min:0,max:5,mode:"fixed",step:1,ticksFrequency:1,tooltip:!1});$("#jqxslider .jqx-slider-tickscontainer:eq(0)").children()}),$(document).ready(function(){$("#ArterialSlowZone").prop("checked",!0),$("#ArterialSlowZone").addClass("active"),$("#SafeStreetsForSeniors").prop("checked",!1),$("#NeighborhoodSlowZone").prop("checked",!1),$("#EngineeringImprovements").prop("checked",!1),$("#SpeedHump").prop("checked",!1),$("#LeadingPedestrianSignals").prop("checked",!1),$("#Schools").prop("checked",!0),$("#Schools").addClass("active"),$("#TLC").prop("checked",!1),$("#TownHallMeeting").prop("checked",!1),$("#Workshops").prop("checked",!1),$("#SeniorCenters").prop("checked",!1),$("#summaryInjuries").prop("checked",!0),$("#summaryInjuries").addClass("active"),police=!0,community=!1,council=!1,injurySum=!0,fatalitySum=!1}),$(".categoriesNav").on(evt,function(){var a=this.id;activeCategory=a,allCrashLayersOff(),removeLayer(),allLayersOff(),setTimeout(function(){CategoryNav(a)},1e3)}),$(".interventionBtns").on(evt,function(){map.infoWindow.hide(),interventionLayerIDs=[];var a=this;interventionLayerIDs.length=0,setTimeout(function(){$(a).hasClass("active")?($(a).css("background-color","#e4e4e4"),$(a).find("i").css("opacity",1),$(a).find("span").css("opacity",1)):($(a).css("background-color","white"),$(a).find("i").css("opacity",.6),$(a).find("span").css("opacity",.6))},20),setTimeout(function(){checkInterventionBtns(interventionLayerIDs)},20)}),$(".outreachBtns").on(evt,function(){map.infoWindow.hide(),outreachLayerIDs=[],outreachLayerIDs.length=0;var a=this;setTimeout(function(){$(a).hasClass("active")?($(this).removeClass("active"),$(a).css("background-color","#e4e4e4"),$(a).find("i").css("opacity",1),$(a).find("span").css("opacity",1)):($(this).addClass("active"),$(a).css("background-color","white"),$(a).find("i").css("opacity",.6),$(a).find("span").css("opacity",.6))},30),setTimeout(function(){checkOutreachBtns(outreachLayerIDs)},20)}),$(".summarySwitchBtns").on(evt,function(){map.infoWindow.hide(),summaryLayerIDs.length=0,console.log(summaryLayerIDs),setTimeout(function(){hasClass("summaryInjuries","active")?($("#summaryFatalities").css("color","#777"),$("#summaryInjuries").css("color","white"),console.log("injury active"),injurySum=!0,fatalitySum=!1):hasClass("summaryFatalities","active")&&($("#summaryInjuries").css("color","#777"),$("#summaryFatalities").css("color","white"),console.log("fatality active"),fatalitySum=!0,injurySum=!1)},20),setTimeout(function(){checkSummaryBtns(summaryLayerIDs)},20)}),$(".districtBtns").on(evt,function(){map.infoWindow.hide();var a=$(this).find("input").attr("id");summaryLayerIDs.length=0;$(".districtBtns").css("background-color","rgb(255,255,255)"),$(".districtBtns").css("color","#777"),$(this).css("background-color","#3276b1"),$(this).css("color","white"),"policePrecinct"==a?(police=!0,community=!1,council=!1,console.log("precinct"),setTimeout(function(){checkSummaryBtns(summaryLayerIDs)},20)):"communityDistrict"==a?(police=!1,community=!0,council=!1,console.log("communityDistrict"),setTimeout(function(){checkSummaryBtns(summaryLayerIDs)},20)):"cityCouncilDistrict"==a&&(police=!1,community=!1,council=!0,console.log("cityCouncilDistrict"),setTimeout(function(){checkSummaryBtns(summaryLayerIDs)},20))}),$(document).ready(function(){$(".dropdown-menu li a").on(evt,function(){var a=$(this).text();$(this).parents(".input-group").find(".dropdown-toggle").html(a+' <span class="caret"></span>')}),LocationSearch()});var stats=[{SUM_CRASHES:13916,SUM_Inj_Crashes:2436,SUM_Fat_Cr:11,SUM_Fatalities:12,SUM_Injuries:3340,SUM_PedFat:11,SUM_PedInj:935,SUM_BikeFat:0,SUM_BikeInj:88,SUM_MVOFat:1,SUM_MVOInj:2317,SUM_Non_Inj:11480,Month:"1/1/2009"},{SUM_CRASHES:12054,SUM_Inj_Crashes:2248,SUM_Fat_Cr:12,SUM_Fatalities:13,SUM_Injuries:3057,SUM_PedFat:9,SUM_PedInj:895,SUM_BikeFat:0,SUM_BikeInj:122,SUM_MVOFat:4,SUM_MVOInj:2040,SUM_Non_Inj:9806,Month:"2/1/2009"},{SUM_CRASHES:13578,SUM_Inj_Crashes:2548,SUM_Fat_Cr:6,SUM_Fatalities:6,SUM_Injuries:3484,SUM_PedFat:4,SUM_PedInj:955,SUM_BikeFat:1,SUM_BikeInj:183,SUM_MVOFat:1,SUM_MVOInj:2346,SUM_Non_Inj:11030,Month:"3/1/2009"},{SUM_CRASHES:13454,SUM_Inj_Crashes:2692,SUM_Fat_Cr:18,SUM_Fatalities:18,SUM_Injuries:3806,SUM_PedFat:8,SUM_PedInj:945,SUM_BikeFat:1,SUM_BikeInj:225,SUM_MVOFat:9,SUM_MVOInj:2636,SUM_Non_Inj:10762,Month:"4/1/2009"},{SUM_CRASHES:14895,SUM_Inj_Crashes:2989,SUM_Fat_Cr:14,SUM_Fatalities:16,SUM_Injuries:4186,SUM_PedFat:10,SUM_PedInj:965,SUM_BikeFat:1,SUM_BikeInj:292,SUM_MVOFat:5,SUM_MVOInj:2929,SUM_Non_Inj:11906,Month:"5/1/2009"},{SUM_CRASHES:14883,SUM_Inj_Crashes:2997,SUM_Fat_Cr:9,SUM_Fatalities:9,SUM_Injuries:4250,SUM_PedFat:3,SUM_PedInj:888,SUM_BikeFat:2,SUM_BikeInj:358,SUM_MVOFat:4,SUM_MVOInj:3004,SUM_Non_Inj:11886,Month:"6/1/2009"},{SUM_CRASHES:14526,SUM_Inj_Crashes:3013,SUM_Fat_Cr:10,SUM_Fatalities:11,SUM_Injuries:4285,SUM_PedFat:7,SUM_PedInj:845,SUM_BikeFat:0,SUM_BikeInj:451,SUM_MVOFat:4,SUM_MVOInj:2989,SUM_Non_Inj:11513,Month:"7/1/2009"},{SUM_CRASHES:14047,SUM_Inj_Crashes:2902,SUM_Fat_Cr:20,SUM_Fatalities:20,SUM_Injuries:4031,SUM_PedFat:9,SUM_PedInj:858,SUM_BikeFat:3,SUM_BikeInj:454,SUM_MVOFat:8,SUM_MVOInj:2719,SUM_Non_Inj:11145,Month:"8/1/2009"},{SUM_CRASHES:13933,SUM_Inj_Crashes:2852,SUM_Fat_Cr:13,SUM_Fatalities:14,SUM_Injuries:3922,SUM_PedFat:9,SUM_PedInj:894,SUM_BikeFat:1,SUM_BikeInj:327,SUM_MVOFat:4,SUM_MVOInj:2701,SUM_Non_Inj:11081,Month:"9/1/2009"},{SUM_CRASHES:15160,SUM_Inj_Crashes:3063,SUM_Fat_Cr:18,SUM_Fatalities:19,SUM_Injuries:4192,SUM_PedFat:10,SUM_PedInj:1098,SUM_BikeFat:0,SUM_BikeInj:304,SUM_MVOFat:9,SUM_MVOInj:2790,SUM_Non_Inj:12097,Month:"10/1/2009"},{SUM_CRASHES:13368,SUM_Inj_Crashes:2653,SUM_Fat_Cr:14,SUM_Fatalities:15,SUM_Injuries:3684,SUM_PedFat:13,SUM_PedInj:942,SUM_BikeFat:0,SUM_BikeInj:240,SUM_MVOFat:2,SUM_MVOInj:2502,SUM_Non_Inj:10715,Month:"11/1/2009"},{SUM_CRASHES:14729,SUM_Inj_Crashes:2696,SUM_Fat_Cr:13,SUM_Fatalities:13,SUM_Injuries:3570,SUM_PedFat:9,SUM_PedInj:1104,SUM_BikeFat:1,SUM_BikeInj:124,SUM_MVOFat:3,SUM_MVOInj:2342,SUM_Non_Inj:12033,Month:"12/1/2009"},{SUM_CRASHES:12589,SUM_Inj_Crashes:2557,SUM_Fat_Cr:16,SUM_Fatalities:16,SUM_Injuries:3505,SUM_PedFat:13,SUM_PedInj:1016,SUM_BikeFat:1,SUM_BikeInj:128,SUM_MVOFat:2,SUM_MVOInj:2361,SUM_Non_Inj:10032,Month:"1/1/2010"},{SUM_CRASHES:12739,SUM_Inj_Crashes:2178,SUM_Fat_Cr:7,SUM_Fatalities:7,SUM_Injuries:2899,SUM_PedFat:5,SUM_PedInj:893,SUM_BikeFat:0,SUM_BikeInj:113,SUM_MVOFat:2,SUM_MVOInj:1893,SUM_Non_Inj:10561,Month:"2/1/2010"},{SUM_CRASHES:14001,SUM_Inj_Crashes:2668,SUM_Fat_Cr:12,SUM_Fatalities:12,SUM_Injuries:3591,SUM_PedFat:7,SUM_PedInj:985,SUM_BikeFat:2,SUM_BikeInj:216,SUM_MVOFat:3,SUM_MVOInj:2390,SUM_Non_Inj:11333,Month:"3/1/2010"},{SUM_CRASHES:13965,SUM_Inj_Crashes:2815,SUM_Fat_Cr:14,SUM_Fatalities:14,SUM_Injuries:3964,SUM_PedFat:9,SUM_PedInj:945,SUM_BikeFat:1,SUM_BikeInj:306,SUM_MVOFat:4,SUM_MVOInj:2713,SUM_Non_Inj:11150,Month:"4/1/2010"},{SUM_CRASHES:15068,SUM_Inj_Crashes:3173,SUM_Fat_Cr:10,SUM_Fatalities:10,SUM_Injuries:4434,SUM_PedFat:5,SUM_PedInj:955,SUM_BikeFat:1,SUM_BikeInj:387,SUM_MVOFat:4,SUM_MVOInj:3092,SUM_Non_Inj:11895,Month:"5/1/2010"},{SUM_CRASHES:15415,SUM_Inj_Crashes:3243,SUM_Fat_Cr:10,SUM_Fatalities:12,SUM_Injuries:4592,SUM_PedFat:3,SUM_PedInj:916,SUM_BikeFat:1,SUM_BikeInj:488,SUM_MVOFat:8,SUM_MVOInj:3188,SUM_Non_Inj:12172,Month:"6/1/2010"},{SUM_CRASHES:14547,SUM_Inj_Crashes:3033,SUM_Fat_Cr:13,SUM_Fatalities:13,SUM_Injuries:4342,SUM_PedFat:7,SUM_PedInj:800,SUM_BikeFat:2,SUM_BikeInj:477,SUM_MVOFat:4,SUM_MVOInj:3065,SUM_Non_Inj:11514,Month:"7/1/2010"},{SUM_CRASHES:14067,SUM_Inj_Crashes:2989,SUM_Fat_Cr:15,SUM_Fatalities:16,SUM_Injuries:4214,SUM_PedFat:5,SUM_PedInj:814,SUM_BikeFat:1,SUM_BikeInj:461,SUM_MVOFat:10,SUM_MVOInj:2939,SUM_Non_Inj:11078,Month:"8/1/2010"},{SUM_CRASHES:14421,SUM_Inj_Crashes:3067,SUM_Fat_Cr:21,SUM_Fatalities:21,SUM_Injuries:4284,SUM_PedFat:14,SUM_PedInj:929,SUM_BikeFat:1,SUM_BikeInj:455,SUM_MVOFat:6,SUM_MVOInj:2900,SUM_Non_Inj:11354,Month:"9/1/2010"},{SUM_CRASHES:14668,SUM_Inj_Crashes:3211,SUM_Fat_Cr:11,SUM_Fatalities:11,SUM_Injuries:4356,SUM_PedFat:8,SUM_PedInj:1131,SUM_BikeFat:1,SUM_BikeInj:376,SUM_MVOFat:2,SUM_MVOInj:2849,SUM_Non_Inj:11457,Month:"10/1/2010"},{SUM_CRASHES:14008,SUM_Inj_Crashes:2928,SUM_Fat_Cr:11,SUM_Fatalities:11,SUM_Injuries:4013,SUM_PedFat:8,SUM_PedInj:1068,SUM_BikeFat:0,SUM_BikeInj:284,SUM_MVOFat:3,SUM_MVOInj:2661,SUM_Non_Inj:11080,Month:"11/1/2010"},{SUM_CRASHES:14539,SUM_Inj_Crashes:2480,SUM_Fat_Cr:7,SUM_Fatalities:7,SUM_Injuries:3359,SUM_PedFat:5,SUM_PedInj:948,SUM_BikeFat:1,SUM_BikeInj:162,SUM_MVOFat:1,SUM_MVOInj:2249,SUM_Non_Inj:12059,Month:"12/1/2010"},{SUM_CRASHES:14148,SUM_Inj_Crashes:2183,SUM_Fat_Cr:8,SUM_Fatalities:9,SUM_Injuries:2973,SUM_PedFat:5,SUM_PedInj:900,SUM_BikeFat:1,SUM_BikeInj:90,SUM_MVOFat:3,SUM_MVOInj:1983,SUM_Non_Inj:11965,Month:"1/1/2011"},{SUM_CRASHES:11756,SUM_Inj_Crashes:1987,SUM_Fat_Cr:13,SUM_Fatalities:13,SUM_Injuries:2625,SUM_PedFat:9,SUM_PedInj:820,SUM_BikeFat:0,SUM_BikeInj:122,SUM_MVOFat:4,SUM_MVOInj:1683,SUM_Non_Inj:9769,Month:"2/1/2011"},{SUM_CRASHES:13043,SUM_Inj_Crashes:2608,SUM_Fat_Cr:9,SUM_Fatalities:9,SUM_Injuries:3501,SUM_PedFat:7,SUM_PedInj:993,SUM_BikeFat:1,SUM_BikeInj:210,SUM_MVOFat:1,SUM_MVOInj:2298,SUM_Non_Inj:10435,Month:"3/1/2011"},{SUM_CRASHES:12526,SUM_Inj_Crashes:2389,SUM_Fat_Cr:12,SUM_Fatalities:12,SUM_Injuries:3327,SUM_PedFat:8,SUM_PedInj:822,SUM_BikeFat:1,SUM_BikeInj:253,SUM_MVOFat:3,SUM_MVOInj:2252,SUM_Non_Inj:10137,Month:"4/1/2011"},{SUM_CRASHES:14202,SUM_Inj_Crashes:3022,SUM_Fat_Cr:10,SUM_Fatalities:10,SUM_Injuries:4209,SUM_PedFat:7,SUM_PedInj:988,SUM_BikeFat:1,SUM_BikeInj:374,SUM_MVOFat:2,SUM_MVOInj:2847,SUM_Non_Inj:11180,Month:"5/1/2011"},{SUM_CRASHES:14341,SUM_Inj_Crashes:3048,SUM_Fat_Cr:9,SUM_Fatalities:9,SUM_Injuries:4184,SUM_PedFat:6,SUM_PedInj:890,SUM_BikeFat:2,SUM_BikeInj:506,SUM_MVOFat:1,SUM_MVOInj:2788,SUM_Non_Inj:11293,Month:"6/1/2011"},{SUM_CRASHES:14374,SUM_Inj_Crashes:3044,SUM_Fat_Cr:13,SUM_Fatalities:13,SUM_Injuries:4298,SUM_PedFat:5,SUM_PedInj:837,SUM_BikeFat:2,SUM_BikeInj:496,SUM_MVOFat:6,SUM_MVOInj:2965,SUM_Non_Inj:11330,Month:"7/1/2011"},{SUM_CRASHES:13605,SUM_Inj_Crashes:2834,SUM_Fat_Cr:15,SUM_Fatalities:16,SUM_Injuries:3883,SUM_PedFat:4,SUM_PedInj:812,SUM_BikeFat:5,SUM_BikeInj:430,SUM_MVOFat:7,SUM_MVOInj:2641,SUM_Non_Inj:10771,Month:"8/1/2011"},{SUM_CRASHES:13844,SUM_Inj_Crashes:2924,SUM_Fat_Cr:17,SUM_Fatalities:17,SUM_Injuries:3972,SUM_PedFat:9,SUM_PedInj:883,SUM_BikeFat:1,SUM_BikeInj:379,SUM_MVOFat:7,SUM_MVOInj:2710,SUM_Non_Inj:10920,Month:"9/1/2011"},{SUM_CRASHES:14282,SUM_Inj_Crashes:3044,SUM_Fat_Cr:19,SUM_Fatalities:19,SUM_Injuries:4053,SUM_PedFat:12,SUM_PedInj:1117,SUM_BikeFat:1,SUM_BikeInj:337,SUM_MVOFat:6,SUM_MVOInj:2599,SUM_Non_Inj:11238,Month:"10/1/2011"},{SUM_CRASHES:13514,SUM_Inj_Crashes:2904,SUM_Fat_Cr:13,SUM_Fatalities:13,SUM_Injuries:3934,SUM_PedFat:8,SUM_PedInj:1130,SUM_BikeFat:1,SUM_BikeInj:244,SUM_MVOFat:4,SUM_MVOInj:2560,SUM_Non_Inj:10610,Month:"11/1/2011"},{SUM_CRASHES:13907,SUM_Inj_Crashes:2915,SUM_Fat_Cr:21,SUM_Fatalities:21,SUM_Injuries:3909,SUM_PedFat:16,SUM_PedInj:1169,SUM_BikeFat:0,SUM_BikeInj:198,SUM_MVOFat:5,SUM_MVOInj:2542,SUM_Non_Inj:10992,Month:"12/1/2011"},{SUM_CRASHES:12689,SUM_Inj_Crashes:2562,SUM_Fat_Cr:16,SUM_Fatalities:16,SUM_Injuries:3433,SUM_PedFat:11,SUM_PedInj:997,SUM_BikeFat:1,SUM_BikeInj:181,SUM_MVOFat:4,SUM_MVOInj:2255,SUM_Non_Inj:10127,Month:"1/1/2012"},{SUM_CRASHES:11709,SUM_Inj_Crashes:2357,SUM_Fat_Cr:13,SUM_Fatalities:13,SUM_Injuries:3169,SUM_PedFat:10,SUM_PedInj:948,SUM_BikeFat:1,SUM_BikeInj:173,SUM_MVOFat:2,SUM_MVOInj:2048,SUM_Non_Inj:9352,Month:"2/1/2012"},{SUM_CRASHES:13313,SUM_Inj_Crashes:2662,SUM_Fat_Cr:14,SUM_Fatalities:14,SUM_Injuries:3699,SUM_PedFat:9,SUM_PedInj:846,SUM_BikeFat:1,SUM_BikeInj:235,SUM_MVOFat:4,SUM_MVOInj:2618,SUM_Non_Inj:10651,Month:"3/1/2012"},{SUM_CRASHES:13362,SUM_Inj_Crashes:2777,SUM_Fat_Cr:17,SUM_Fatalities:17,SUM_Injuries:3823,SUM_PedFat:9,SUM_PedInj:881,SUM_BikeFat:5,SUM_BikeInj:312,SUM_MVOFat:3,SUM_MVOInj:2630,SUM_Non_Inj:10585,Month:"4/1/2012"},{SUM_CRASHES:14438,SUM_Inj_Crashes:2929,SUM_Fat_Cr:25,SUM_Fatalities:26,SUM_Injuries:3915,SUM_PedFat:15,SUM_PedInj:856,SUM_BikeFat:1,SUM_BikeInj:368,SUM_MVOFat:10,SUM_MVOInj:2691,SUM_Non_Inj:11509,Month:"5/1/2012"},{SUM_CRASHES:14662,SUM_Inj_Crashes:2888,SUM_Fat_Cr:20,SUM_Fatalities:21,SUM_Injuries:3963,SUM_PedFat:10,SUM_PedInj:887,SUM_BikeFat:2,SUM_BikeInj:366,SUM_MVOFat:9,SUM_MVOInj:2710,SUM_Non_Inj:11774,Month:"6/1/2012"},{SUM_CRASHES:13808,SUM_Inj_Crashes:2861,SUM_Fat_Cr:17,SUM_Fatalities:21,SUM_Injuries:3895,SUM_PedFat:5,SUM_PedInj:796,SUM_BikeFat:3,SUM_BikeInj:430,SUM_MVOFat:13,SUM_MVOInj:2669,SUM_Non_Inj:10947,Month:"7/1/2012"},{SUM_CRASHES:13930,SUM_Inj_Crashes:2872,SUM_Fat_Cr:21,SUM_Fatalities:22,SUM_Injuries:3799,SUM_PedFat:13,SUM_PedInj:806,SUM_BikeFat:1,SUM_BikeInj:488,SUM_MVOFat:8,SUM_MVOInj:2505,SUM_Non_Inj:11058,Month:"8/1/2012"},{SUM_CRASHES:13410,SUM_Inj_Crashes:2781,SUM_Fat_Cr:21,SUM_Fatalities:21,SUM_Injuries:3743,SUM_PedFat:13,SUM_PedInj:848,SUM_BikeFat:1,SUM_BikeInj:414,SUM_MVOFat:7,SUM_MVOInj:2481,SUM_Non_Inj:10629,Month:"9/1/2012"},{SUM_CRASHES:13731,SUM_Inj_Crashes:2777,SUM_Fat_Cr:17,SUM_Fatalities:17,SUM_Injuries:3740,SUM_PedFat:11,SUM_PedInj:929,SUM_BikeFat:1,SUM_BikeInj:317,SUM_MVOFat:5,SUM_MVOInj:2494,SUM_Non_Inj:10954,Month:"10/1/2012"},{SUM_CRASHES:12950,SUM_Inj_Crashes:2502,SUM_Fat_Cr:12,SUM_Fatalities:12,SUM_Injuries:3302,SUM_PedFat:7,SUM_PedInj:974,SUM_BikeFat:0,SUM_BikeInj:264,SUM_MVOFat:5,SUM_MVOInj:2064,SUM_Non_Inj:10448,Month:"11/1/2012"},{SUM_CRASHES:13878,SUM_Inj_Crashes:2884,SUM_Fat_Cr:22,SUM_Fatalities:23,SUM_Injuries:3760,SUM_PedFat:15,SUM_PedInj:1217,SUM_BikeFat:0,SUM_BikeInj:205,SUM_MVOFat:8,SUM_MVOInj:2338,SUM_Non_Inj:10994,Month:"12/1/2012"},{SUM_CRASHES:12787,SUM_Inj_Crashes:2537,SUM_Fat_Cr:24,SUM_Fatalities:26,SUM_Injuries:3276,SUM_PedFat:19,SUM_PedInj:1049,SUM_BikeFat:0,SUM_BikeInj:184,SUM_MVOFat:7,SUM_MVOInj:2043,SUM_Non_Inj:10250,Month:"1/1/2013"},{SUM_CRASHES:11896,SUM_Inj_Crashes:2192,SUM_Fat_Cr:17,SUM_Fatalities:17,SUM_Injuries:2859,SUM_PedFat:11,SUM_PedInj:936,SUM_BikeFat:0,SUM_BikeInj:125,SUM_MVOFat:6,SUM_MVOInj:1798,SUM_Non_Inj:9704,Month:"2/1/2013"},{SUM_CRASHES:13625,SUM_Inj_Crashes:2535,SUM_Fat_Cr:18,SUM_Fatalities:20,SUM_Injuries:3444,SUM_PedFat:11,SUM_PedInj:934,SUM_BikeFat:1,SUM_BikeInj:191,SUM_MVOFat:8,SUM_MVOInj:2319,SUM_Non_Inj:11090,Month:"3/1/2013"},{SUM_CRASHES:13549,SUM_Inj_Crashes:2710,SUM_Fat_Cr:12,SUM_Fatalities:13,SUM_Injuries:3667,SUM_PedFat:9,SUM_PedInj:857,SUM_BikeFat:0,SUM_BikeInj:284,SUM_MVOFat:4,SUM_MVOInj:2526,SUM_Non_Inj:10839,Month:"4/1/2013"},{SUM_CRASHES:15204,SUM_Inj_Crashes:3071,SUM_Fat_Cr:13,SUM_Fatalities:13,SUM_Injuries:4134,SUM_PedFat:6,SUM_PedInj:930,SUM_BikeFat:2,SUM_BikeInj:389,SUM_MVOFat:5,SUM_MVOInj:2815,SUM_Non_Inj:12133,Month:"5/1/2013"},{SUM_CRASHES:14834,SUM_Inj_Crashes:3081,SUM_Fat_Cr:17,SUM_Fatalities:17,SUM_Injuries:4197,SUM_PedFat:10,SUM_PedInj:902,SUM_BikeFat:3,SUM_BikeInj:495,SUM_MVOFat:4,SUM_MVOInj:2800,SUM_Non_Inj:11753,Month:"6/1/2013"},{SUM_CRASHES:14340,SUM_Inj_Crashes:3021,SUM_Fat_Cr:22,SUM_Fatalities:22,SUM_Injuries:4194,SUM_PedFat:13,SUM_PedInj:810,SUM_BikeFat:0,SUM_BikeInj:449,SUM_MVOFat:9,SUM_MVOInj:2935,SUM_Non_Inj:11319,Month:"7/1/2013"},{SUM_CRASHES:13548,SUM_Inj_Crashes:2930,SUM_Fat_Cr:25,SUM_Fatalities:27,SUM_Injuries:3930,SUM_PedFat:12,SUM_PedInj:808,SUM_BikeFat:1,SUM_BikeInj:499,SUM_MVOFat:14,SUM_MVOInj:2623,SUM_Non_Inj:10618,Month:"8/1/2013"},{SUM_CRASHES:13761,SUM_Inj_Crashes:3001,SUM_Fat_Cr:20,SUM_Fatalities:21,SUM_Injuries:4077,SUM_PedFat:12,SUM_PedInj:945,SUM_BikeFat:0,SUM_BikeInj:457,SUM_MVOFat:9,SUM_MVOInj:2675,SUM_Non_Inj:10760,Month:"9/1/2013"},{SUM_CRASHES:14343,SUM_Inj_Crashes:2956,SUM_Fat_Cr:19,SUM_Fatalities:19,SUM_Injuries:3936,SUM_PedFat:13,SUM_PedInj:997,SUM_BikeFat:2,SUM_BikeInj:411,SUM_MVOFat:4,SUM_MVOInj:2528,SUM_Non_Inj:11387,Month:"10/1/2013"},{SUM_CRASHES:14389,SUM_Inj_Crashes:2853,SUM_Fat_Cr:25,SUM_Fatalities:26,SUM_Injuries:3789,SUM_PedFat:20,SUM_PedInj:1044,SUM_BikeFat:2,SUM_BikeInj:270,SUM_MVOFat:4,SUM_MVOInj:2475,SUM_Non_Inj:11536,Month:"11/1/2013"},{SUM_CRASHES:14147,SUM_Inj_Crashes:2661,SUM_Fat_Cr:20,SUM_Fatalities:21,SUM_Injuries:3479,SUM_PedFat:14,SUM_PedInj:1097,SUM_BikeFat:0,SUM_BikeInj:169,SUM_MVOFat:7,SUM_MVOInj:2213,SUM_Non_Inj:11486,Month:"12/1/2013"},{SUM_CRASHES:13513,SUM_Inj_Crashes:2431,SUM_Fat_Cr:18,SUM_Fatalities:18,SUM_Injuries:3191,SUM_PedFat:12,SUM_PedInj:1022,SUM_BikeFat:1,SUM_BikeInj:115,SUM_MVOFat:5,SUM_MVOInj:2054,SUM_Non_Inj:11082,Month:"1/1/2014"},{SUM_CRASHES:12979,SUM_Inj_Crashes:1888,SUM_Fat_Cr:9,SUM_Fatalities:9,SUM_Injuries:2469,SUM_PedFat:7,SUM_PedInj:764,SUM_BikeFat:1,SUM_BikeInj:90,SUM_MVOFat:1,SUM_MVOInj:1615,SUM_Non_Inj:11091,Month:"2/1/2014"},{SUM_CRASHES:12902,SUM_Inj_Crashes:2306,SUM_Fat_Cr:16,SUM_Fatalities:16,SUM_Injuries:3090,SUM_PedFat:10,SUM_PedInj:882,SUM_BikeFat:0,SUM_BikeInj:177,SUM_MVOFat:6,SUM_MVOInj:2031,SUM_Non_Inj:10596,Month:"3/1/2014"},{SUM_CRASHES:13123,SUM_Inj_Crashes:2439,SUM_Fat_Cr:17,SUM_Fatalities:20,SUM_Injuries:3250,SUM_PedFat:8,SUM_PedInj:798,SUM_BikeFat:2,SUM_BikeInj:292,SUM_MVOFat:10,SUM_MVOInj:2160,SUM_Non_Inj:10684,Month:"4/1/2014"},{SUM_CRASHES:14480,SUM_Inj_Crashes:2689,SUM_Fat_Cr:18,SUM_Fatalities:19,SUM_Injuries:3659,SUM_PedFat:7,SUM_PedInj:824,SUM_BikeFat:2,SUM_BikeInj:363,SUM_MVOFat:10,SUM_MVOInj:2472,SUM_Non_Inj:11791,Month:"5/1/2014"},{SUM_CRASHES:14699,SUM_Inj_Crashes:2912,SUM_Fat_Cr:16,SUM_Fatalities:16,SUM_Injuries:4036,SUM_PedFat:6,SUM_PedInj:879,SUM_BikeFat:3,SUM_BikeInj:450,SUM_MVOFat:7,SUM_MVOInj:2707,SUM_Non_Inj:11787,Month:"6/1/2014"},{SUM_CRASHES:13659,SUM_Inj_Crashes:2759,SUM_Fat_Cr:21,SUM_Fatalities:21,SUM_Injuries:3648,SUM_PedFat:11,SUM_PedInj:711,SUM_BikeFat:2,SUM_BikeInj:506,SUM_MVOFat:8,SUM_MVOInj:2431,SUM_Non_Inj:10900,Month:"7/1/2014"}],stats2=[{SUM_CRASHES:168543,SUM_Inj_Crashes:33089,SUM_Fat_Crashes:158,SUM_Fatalities:166,SUM_Injuries:45807,SUM_PedFat:102,SUM_PedInj:11324,SUM_BikeFat:10,SUM_BikeInj:3168,SUM_MVOFat:54,SUM_MVOInj:31315,SUM_Non_Inj:135454,Year:2009},{SUM_CRASHES:170027,SUM_Inj_Crashes:34342,SUM_Fat_Crashes:147,SUM_Fatalities:150,SUM_Injuries:47553,SUM_PedFat:89,SUM_PedInj:11400,SUM_BikeFat:12,SUM_BikeInj:3853,SUM_MVOFat:49,SUM_MVOInj:32300,SUM_Non_Inj:135685,Year:2010},{SUM_CRASHES:163542,SUM_Inj_Crashes:32902,SUM_Fat_Crashes:159,SUM_Fatalities:161,SUM_Injuries:44868,SUM_PedFat:96,SUM_PedInj:11361,SUM_BikeFat:16,SUM_BikeInj:3639,SUM_MVOFat:49,SUM_MVOInj:29868,SUM_Non_Inj:130640,Year:2011},{SUM_CRASHES:161880,SUM_Inj_Crashes:32852,SUM_Fat_Crashes:215,SUM_Fatalities:223,SUM_Injuries:44241,SUM_PedFat:128,SUM_PedInj:10985,SUM_BikeFat:17,SUM_BikeInj:3753,SUM_MVOFat:78,SUM_MVOInj:29503,SUM_Non_Inj:129028,Year:2012},{SUM_CRASHES:166423,SUM_Inj_Crashes:33548,SUM_Fat_Crashes:232,SUM_Fatalities:242,SUM_Injuries:44982,SUM_PedFat:150,SUM_PedInj:11309,SUM_BikeFat:11,SUM_BikeInj:3923,SUM_MVOFat:81,SUM_MVOInj:29750,SUM_Non_Inj:132875,Year:2013},{SUM_CRASHES:96862,SUM_Inj_Crashes:17720,SUM_Fat_Crashes:117,SUM_Fatalities:121,SUM_Injuries:23746,SUM_PedFat:62,SUM_PedInj:5964,SUM_BikeFat:11,SUM_BikeInj:2030,SUM_MVOFat:48,SUM_MVOInj:15752,SUM_Non_Inj:79142,Year:2014}];
$("#jqxslider").bind("change",function(){checkStats()}),$("#jqxslider2").bind("change",function(){checkStats()});var siteOverlay=$("#site-overlay"),siteWrapper=$("#site-wrapper");$(function(){siteOverlay.fadeOut("fast"),$(".toggle-nav").click(function(){siteWrapper.toggleClass("show-nav"),siteOverlay.fadeIn("fast")}),$(document).keyup(function(a){27==a.keyCode&&siteWrapper.hasClass("show-nav")&&(siteOverlay.fadeOut("fast"),siteWrapper.toggleClass("show-nav"))}),siteOverlay.click(function(){siteOverlay.fadeOut("fast"),siteWrapper.toggleClass("show-nav")})}),$(document).ready(function(){var a=$("#monthSelect");$("#yearlyBtn").click(function(){a.hide()}),$("#monthlyBtn").click(function(){a.show()})});var arcgisserver="a841-dotqaweb01.nyc.gov";$("#smallScreenGeolocate").on(evt,function(){getCurrentLocation()}),$("#smallScreenInfo").on(evt,function(){if(fatality||injury)$("#smallScreenModalInfo").html("Injuries and fatalities are grouped by intersection and summarized by month and year using Motor Vehicle Collision data provided by NYPD.  Current year is January to the end of the latest full month.");else if(interventions){var a="<i>Leading Pedestrian Interval Signals</i><br>Intersections where DOT adjusts signal timing to show a walk sign for pedestrians before showing a green light to vehicle traffic. The goal of these signals is to improve street safety by giving pedestrians a chance to establish their presence in the crosswalk before vehicles make turns across that crosswalk.";a+="<br><br><i>Major Safety Projects</i><br>Safety-oriented engineering projects that use multiple treatments (signals, markings, concrete etc) on both corridors and intersections. Improvements are generally aimed at calming and better organizing traffic, creating shorter, safer pedestrian crossings, expanding pedestrian space, improving travel times and creating safe routes for bicycle travel. The map displays DOT operational (non-capital) projects from 2013 and 2014.",a+="<br><br><i>Arterial Slow Zones</i><br>The Arterial Slow Zone program uses a combination of a lower speed limit, signal timing changes, distinctive signs and increased enforcement to improve safety on some of New York City's most high-crash corridors.  <br> <br>",a+="<i>Speed Humps</i><br>Speed Humps are a raised area of a roadway designed to reduce vehicle speeds. <br><br>",a+="<i>Safe Streets for Seniors</i><br>The Safe Streets for Seniors program is an initiative aimed at increasing safety for older New Yorkers. Based on factors such as senior population density, injury crashes, and senior trip generators, DOT has selected and studied 25 Senior Pedestrian Focus Areas. Within these areas, DOT expands pedestrian crossing time to allow for slower senior walking speeds, evaluates potential safety improvements and also conducts education outreach to senior centers.",a+="<br><br><i>Neighborhood Slow Zones</i><br>The Neighborhood Slow Zone program is an application based program which takes a neighborhood area and reduces the speed limit to 20 mph. Areas are chosen based on crashes, presence of schools and other neighborhood amenities and community support. The treatments include a mixture of markings, signage, and speed humps.",$("#smallScreenModalInfo").html(a)}else if(outreach){var b=" <i>Schools</i><br> DOT is conducting outreach to numerous schools in the five boroughs, using age-appropriate materials to educate school children about traffic safety. <br><br>";b+="<i>Senior Centers</i><br>DOT is partnering with Senior Centers across New York City to increase communication and obtain specific feedback from older New Yorkers about the challenges they face and potential street safety improvements. <br><br>",b+="<i>TLC</i><br>As a partner agency in the Vision Zero Initiative, the Taxi and Limousine Commission has committed to implement a number of safety reforms designed to increase driver awareness, step up enforcement, and improve technology. Educating drivers about Vision Zero is a key strategy TLC is using to work towards the goal of zero traffic fatalities by 2020.  In addition to updating taxi school to put a greater focus on traffic safety and to make sure drivers know how to safety navigate new street features, such as bike lanes, bus lanes, and mixing zones, TLC staff are visiting for-hire vehicle bases, taxi fleets, and other venues around the city where they can speak to drivers about Vision Zero.  At these meetings, TLC provides information on behaviors that cause serious crashes and tips for safe driving.  At the end of these sessions, drivers are invited to sign the TLC Safe Driver Pledge to demonstrate their personal commitment to safe driving.  TLC also regularly engages industry stakeholder groups in Vision Zero through small group meetings and Commission meetings.  These groups provide feedback on TLCs implementation of the Vision Zero Action Plan and, because they communicate regularly with drivers, are excellent partners for ensuring that all drivers prioritize safe driving. <br><br>",b+="<i>Town Hall Meetings</i><br>In Spring 2014, DOT partnered with New York City Councilmembers across the five boroughs to host a number of Town Halls, where community members could come learn more about Vision Zero and give specific suggestions or concerns regarding traffic safety in their neighborhoods.<br><br>",b+="<i>Workshops</i><br>In Spring 2014, DOT hosted nine pedestrian safety workshops across the five boroughs aimed at gathering community feedback on areas in need of safety improvements. This feedback will be used to shape the Borough Pedestrian Safety Action Plans, to be released later in 2014.",$("#smallScreenModalInfo").html(b)}else if(fatalitySum||injurySum){var c="<i>Police Precinct</i><br>New York City is divided into a number of police precincts with officers who manage enforcement within that area.<br><br>";c+="<i>Community District</i><br>New York City is comprised of five boroughs, containing 59 community districts citywide established by local law in 1975. Local communities are represented by community boards that create opportunity for active participation in the political process and provision of services to address evolving community needs. <br><br>",c+="<i>City Council District</i><br>New York City is divided into 51 City Council districts, each represented by a councilmember elected by residents of the district.<br><br>",c+="<i>Density of Injuries by (Police Precinct, Community District, City Council District)</i><br>Number of traffic injuries and fatalities occurring in a given area, normalized by the population of that area.",$("#smallScreenModalInfo").html(c)}}),$("#smallScreenLegend").on(evt,function(){var a,b=map.getScale();injury?yearly?b>64e3?(a="Density of All Injuries By Year<br>",a+="<img src='img/legend/Injury_Heat.svg' class='img-responsive text-center' alt='Responsive image' style='width: 100%; margin-top: 1em;'>",a+="<h6><span style='margin-left: 0.2em;' class='pull-left'>Low</span><span class='pull-right'>High</span></h6>"):64001>b&&(a="Number of Pedestrian Injuries and Fatalities: Yearly<br>",a+="<img src='img/legend/Injury_Leg.svg' class='img-responsive text-center' alt='Responsive image' style='width: auto; margin-top: 0.3em;'><br>",a+="<img src='img/legend/Fatal_Leg.svg' class='img-responsive text-center' alt='Responsive image' style='width: auto; margin-top: 1.7em;'>"):monthly&&(a="Number of Pedestrian Injuries and Fatalities: Monthly",a+="<img src='img/legend/Injury_Leg.svg' class='img-responsive text-center' alt='Responsive image' style='width: auto; margin-top: 0.3em;'><br>",a+="<img src='img/legend/Fatal_Leg.svg' class='img-responsive text-center' alt='Responsive image' style='width: auto; margin-top: 1.7em;'>"):fatality?(a="Number of Pedestrian Fatalities: Monthly",a+="<img src='img/legend/Fatal_Leg.svg' class='img-responsive text-center' alt='Responsive image' style='width: auto; margin-top: 1.7em;'>"):outreach?a="<img src='img/legend/Outreach_leg.svg' class='img-responsive text-center' alt='Responsive image' style='width: 100%; margin-top: 1em;'>":interventions?(console.log("get here"),a="<img src='img/legend/Intervention_Leg.svg' class='text-center' alt='Responsive image' style='width: 100%; margin-top: 1em;'>"):injurySum?(police?a="Density of Injuries by Police Precinct<br>":community?a="Density of Injuries by Community District<br>":council&&(a="Density of Injuries by City Council District<br>"),a+="<img src='img/legend/Injury_Sum.svg' class='img-responsive text-center' alt='Responsive image' style='width: 100%; margin-top: 1em;'>",a+="<h6><span style='margin-left: 0.2em;' class='pull-left'>Low</span><span class='pull-right'>High</span></h6>"):fatalitySum&&(console.log("how bout her"),police?a="Density of Fatalities by Police Precinct<br>":community?a="Density of Fatalities by Community District<br>":council&&(a="Density of Fatalities by City Council District<br>"),a+="<img src='img/legend/Fatal_Sum.svg' class='img-responsive text-center' alt='Responsive image' style='width: 100%; margin-top: 1em;'>",a+="<h6><span style='margin-left: 0.2em;' class='pull-left'>Low</span><span class='pull-right'>High</span></h6>"),$("#smallScreenModalLegend").html(a)});var selectMonthVal,selectYearVal;$("#monthSelect, #yearSelect").on("change",function(){var a=$("#monthSelect").val(),b=$("#yearSelect").val();selectMonthVal=parseInt(a),selectYearVal=parseInt(b),checkStats()});